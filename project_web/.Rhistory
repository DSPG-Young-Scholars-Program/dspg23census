df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("report", data_to_use[i,4]))){
new_row <- c("report", "employment",54)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("map", data_to_use[i,4]))){
new_row <- c("map", "employment",54)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("visualization", data_to_use[i,4]))){
new_row <- c("data visualization", "employment",54)
df_stack2 <- rbind(df_stack2, new_row)
}
}
#---------------------------tax----------------------------
if (any(grepl("tax", data_to_use[i,3]))) {
if(any(grepl("table download", data_to_use[i,4]))){
new_row <- c("table download", "tax",9)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("table", data_to_use[i,4]))){
new_row <- c("table", "tax",9)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("report", data_to_use[i,4]))){
new_row <- c("report", "tax",9)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("map", data_to_use[i,4]))){
new_row <- c("map", "tax",9)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("visualization", data_to_use[i,4]))){
new_row <- c("data visualization", "tax",9)
df_stack2 <- rbind(df_stack2, new_row)
}
}
#---------------------------labor force----------------------------
if (any(grepl("labor force", data_to_use[i,3]))) {
if(any(grepl("table download", data_to_use[i,4]))){
new_row <- c("table download", "labor force",18)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("table", data_to_use[i,4]))){
new_row <- c("table", "labor force",18)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("report", data_to_use[i,4]))){
new_row <- c("report", "labor force",18)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("map", data_to_use[i,4]))){
new_row <- c("map", "labor force",18)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("visualization", data_to_use[i,4]))){
new_row <- c("data visualization", "labor force",18)
df_stack2 <- rbind(df_stack2, new_row)
}
}
#---------------------------wage----------------------------
if (any(grepl("wage", data_to_use[i,3]))) {
if(any(grepl("table download", data_to_use[i,4]))){
new_row <- c("table download", "wage",22)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("table", data_to_use[i,4]))){
new_row <- c("table", "wage",22)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("report", data_to_use[i,4]))){
new_row <- c("report", "wage",22)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("map", data_to_use[i,4]))){
new_row <- c("map", "wage",22)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("visualization", data_to_use[i,4]))){
new_row <- c("data visualization", "wage",22)
df_stack2 <- rbind(df_stack2, new_row)
}
}
#---------------------------job----------------------------
if (any(grepl("job", data_to_use[i,3]))) {
if(any(grepl("table download", data_to_use[i,4]))){
new_row <- c("table download", "job",9)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("table", data_to_use[i,4]))){
new_row <- c("table", "job",9)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("report", data_to_use[i,4]))){
new_row <- c("report", "job",9)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("map", data_to_use[i,4]))){
new_row <- c("map", "job",9)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("visualization", data_to_use[i,4]))){
new_row <- c("data visualization", "job",9)
df_stack2 <- rbind(df_stack2, new_row)
}
}
#---------------------------economy----------------------------
if (any(grepl("economy", data_to_use[i,3]))) {
if(any(grepl("table download", data_to_use[i,4]))){
new_row <- c("table download", "economy",38)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("table", data_to_use[i,4]))){
new_row <- c("table", "economy",38)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("report", data_to_use[i,4]))){
new_row <- c("report", "economy",38)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("map", data_to_use[i,4]))){
new_row <- c("map", "economy",38)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("visualization", data_to_use[i,4]))){
new_row <- c("data visualization", "economy",38)
df_stack2 <- rbind(df_stack2, new_row)
}
}
}
colnames(df_stack2) <- col_name
}
library(gcookbook) # Load gcookbook for the cabbage_exp data set
ggplot(df_stack2, aes(x = sub, y = 1, fill = tool)) +
geom_col() +
scale_fill_manual(values = cbPalette) +
xlab("sub-category")+
ylab("count")+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
sub_cat_and_tool <- function(selected_state){
df_stack2 <- data.frame(
tool = character(),
sub = character(),
count = numeric()
)
col_name = c("tool","sub","count")
colnames(df_stack2) <- col_name
if (selected_state == "All states" ){
data_to_use = data
}
else{
data_to_use = data[data$State..Country== selected_state,]
}
for (i in 1:nrow(data_to_use)) {
#--------------------------income----------------------------
if (any(grepl("income", data_to_use[i,3]))) {
if(any(grepl("table download", data_to_use[i,4]))){
new_row <- c("table download", "income",46)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("table", data_to_use[i,4]))){
new_row <- c("table", "income",46)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("report", data_to_use[i,4]))){
new_row <- c("report", "income",46)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("map", data_to_use[i,4]))){
new_row <- c("map", "income",46)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("visualization", data_to_use[i,4]))){
new_row <- c("data visualization", "income",46)
df_stack2 <- rbind(df_stack2, new_row)
}
}
#---------------------------employment----------------------------
if (any(grepl("employment", data_to_use[i,3]))) {
if(any(grepl("table download", data_to_use[i,4]))){
new_row <- c("table download", "employment",54)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("table", data_to_use[i,4]))){
new_row <- c("table", "employment",54)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("report", data_to_use[i,4]))){
new_row <- c("report", "employment",54)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("map", data_to_use[i,4]))){
new_row <- c("map", "employment",54)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("visualization", data_to_use[i,4]))){
new_row <- c("data visualization", "employment",54)
df_stack2 <- rbind(df_stack2, new_row)
}
}
#---------------------------tax----------------------------
if (any(grepl("tax", data_to_use[i,3]))) {
if(any(grepl("table download", data_to_use[i,4]))){
new_row <- c("table download", "tax",9)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("table", data_to_use[i,4]))){
new_row <- c("table", "tax",9)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("report", data_to_use[i,4]))){
new_row <- c("report", "tax",9)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("map", data_to_use[i,4]))){
new_row <- c("map", "tax",9)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("visualization", data_to_use[i,4]))){
new_row <- c("data visualization", "tax",9)
df_stack2 <- rbind(df_stack2, new_row)
}
}
#---------------------------labor force----------------------------
if (any(grepl("labor force", data_to_use[i,3]))) {
if(any(grepl("table download", data_to_use[i,4]))){
new_row <- c("table download", "labor force",18)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("table", data_to_use[i,4]))){
new_row <- c("table", "labor force",18)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("report", data_to_use[i,4]))){
new_row <- c("report", "labor force",18)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("map", data_to_use[i,4]))){
new_row <- c("map", "labor force",18)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("visualization", data_to_use[i,4]))){
new_row <- c("data visualization", "labor force",18)
df_stack2 <- rbind(df_stack2, new_row)
}
}
#---------------------------wage----------------------------
if (any(grepl("wage", data_to_use[i,3]))) {
if(any(grepl("table download", data_to_use[i,4]))){
new_row <- c("table download", "wage",22)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("table", data_to_use[i,4]))){
new_row <- c("table", "wage",22)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("report", data_to_use[i,4]))){
new_row <- c("report", "wage",22)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("map", data_to_use[i,4]))){
new_row <- c("map", "wage",22)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("visualization", data_to_use[i,4]))){
new_row <- c("data visualization", "wage",22)
df_stack2 <- rbind(df_stack2, new_row)
}
}
#---------------------------job----------------------------
if (any(grepl("job", data_to_use[i,3]))) {
if(any(grepl("table download", data_to_use[i,4]))){
new_row <- c("table download", "job",9)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("table", data_to_use[i,4]))){
new_row <- c("table", "job",9)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("report", data_to_use[i,4]))){
new_row <- c("report", "job",9)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("map", data_to_use[i,4]))){
new_row <- c("map", "job",9)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("visualization", data_to_use[i,4]))){
new_row <- c("data visualization", "job",9)
df_stack2 <- rbind(df_stack2, new_row)
}
}
#---------------------------economy----------------------------
if (any(grepl("economy", data_to_use[i,3]))) {
if(any(grepl("table download", data_to_use[i,4]))){
new_row <- c("table download", "economy",38)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("table", data_to_use[i,4]))){
new_row <- c("table", "economy",38)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("report", data_to_use[i,4]))){
new_row <- c("report", "economy",38)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("map", data_to_use[i,4]))){
new_row <- c("map", "economy",38)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("visualization", data_to_use[i,4]))){
new_row <- c("data visualization", "economy",38)
df_stack2 <- rbind(df_stack2, new_row)
}
}
}
colnames(df_stack2) <- col_name
}
sub_cat_and_tool("All states")
sub_cat_and_tool("All states")
sub_cat_and_tool <- function(selected_state){
df_stack2 <- data.frame(
tool = character(),
sub = character(),
count = numeric()
)
col_name = c("tool","sub","count")
colnames(df_stack2) <- col_name
if (selected_state == "All states" ){
data_to_use = data
}
else{
data_to_use = data[data$State..Country== selected_state,]
}
for (i in 1:nrow(data_to_use)) {
#--------------------------income----------------------------
if (any(grepl("income", data_to_use[i,3]))) {
if(any(grepl("table download", data_to_use[i,4]))){
new_row <- c("table download", "income",46)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("table", data_to_use[i,4]))){
new_row <- c("table", "income",46)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("report", data_to_use[i,4]))){
new_row <- c("report", "income",46)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("map", data_to_use[i,4]))){
new_row <- c("map", "income",46)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("visualization", data_to_use[i,4]))){
new_row <- c("data visualization", "income",46)
df_stack2 <- rbind(df_stack2, new_row)
}
}
#---------------------------employment----------------------------
if (any(grepl("employment", data_to_use[i,3]))) {
if(any(grepl("table download", data_to_use[i,4]))){
new_row <- c("table download", "employment",54)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("table", data_to_use[i,4]))){
new_row <- c("table", "employment",54)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("report", data_to_use[i,4]))){
new_row <- c("report", "employment",54)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("map", data_to_use[i,4]))){
new_row <- c("map", "employment",54)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("visualization", data_to_use[i,4]))){
new_row <- c("data visualization", "employment",54)
df_stack2 <- rbind(df_stack2, new_row)
}
}
#---------------------------tax----------------------------
if (any(grepl("tax", data_to_use[i,3]))) {
if(any(grepl("table download", data_to_use[i,4]))){
new_row <- c("table download", "tax",9)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("table", data_to_use[i,4]))){
new_row <- c("table", "tax",9)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("report", data_to_use[i,4]))){
new_row <- c("report", "tax",9)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("map", data_to_use[i,4]))){
new_row <- c("map", "tax",9)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("visualization", data_to_use[i,4]))){
new_row <- c("data visualization", "tax",9)
df_stack2 <- rbind(df_stack2, new_row)
}
}
#---------------------------labor force----------------------------
if (any(grepl("labor force", data_to_use[i,3]))) {
if(any(grepl("table download", data_to_use[i,4]))){
new_row <- c("table download", "labor force",18)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("table", data_to_use[i,4]))){
new_row <- c("table", "labor force",18)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("report", data_to_use[i,4]))){
new_row <- c("report", "labor force",18)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("map", data_to_use[i,4]))){
new_row <- c("map", "labor force",18)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("visualization", data_to_use[i,4]))){
new_row <- c("data visualization", "labor force",18)
df_stack2 <- rbind(df_stack2, new_row)
}
}
#---------------------------wage----------------------------
if (any(grepl("wage", data_to_use[i,3]))) {
if(any(grepl("table download", data_to_use[i,4]))){
new_row <- c("table download", "wage",22)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("table", data_to_use[i,4]))){
new_row <- c("table", "wage",22)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("report", data_to_use[i,4]))){
new_row <- c("report", "wage",22)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("map", data_to_use[i,4]))){
new_row <- c("map", "wage",22)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("visualization", data_to_use[i,4]))){
new_row <- c("data visualization", "wage",22)
df_stack2 <- rbind(df_stack2, new_row)
}
}
#---------------------------job----------------------------
if (any(grepl("job", data_to_use[i,3]))) {
if(any(grepl("table download", data_to_use[i,4]))){
new_row <- c("table download", "job",9)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("table", data_to_use[i,4]))){
new_row <- c("table", "job",9)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("report", data_to_use[i,4]))){
new_row <- c("report", "job",9)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("map", data_to_use[i,4]))){
new_row <- c("map", "job",9)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("visualization", data_to_use[i,4]))){
new_row <- c("data visualization", "job",9)
df_stack2 <- rbind(df_stack2, new_row)
}
}
#---------------------------economy----------------------------
if (any(grepl("economy", data_to_use[i,3]))) {
if(any(grepl("table download", data_to_use[i,4]))){
new_row <- c("table download", "economy",38)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("table", data_to_use[i,4]))){
new_row <- c("table", "economy",38)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("report", data_to_use[i,4]))){
new_row <- c("report", "economy",38)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("map", data_to_use[i,4]))){
new_row <- c("map", "economy",38)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("visualization", data_to_use[i,4]))){
new_row <- c("data visualization", "economy",38)
df_stack2 <- rbind(df_stack2, new_row)
}
}
}
colnames(df_stack2) <- col_name
ggplot(df_stack2, aes(x = sub, y = 1, fill = tool)) +
geom_col() +
scale_fill_manual(values = cbPalette) +
xlab("sub-category")+
ylab("count")+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
sub_cat_and_tool("All states")
sub_cat_and_tool("Alabama")
sub_cat_and_tool("California")
sub_cat_and_tool("Colorado")
sub_cat_and_tool("All states")
runApp('web_code.R')
