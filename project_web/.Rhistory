if (any(grepl("income", i))) {
income <- income + 1
}
if (any(grepl("economy", i))) {
economy <- economy + 1
}
}
# Create data frame for plotting
category <- c("employment", "income", "tax", "labor force", "wage", "job", "economy")
counts <- c(employment, income, tax, lf, wage, job, economy)
total_df <- data.frame(category, counts)
# Barplot
barplot(counts, names.arg = category, col = "steelblue",
main = paste("Distribution of Data Tools' Category in", selected_state),
xlab = "Category", ylab = "counts", cex.names = 0.9, ylim = c(0, 60))
# Add counts as text above the bars
text(x = c(0.7, 1.9, 3.1, 4.3, 5.5, 6.7, 7.9), y = counts,
labels = counts, pos = 3, cex = 0.8, col = "black")
}
data$Sub.categories = tolower(data$Sub.categories)
econ_category_plot("All states")
tool_category <-sample(c("table download","table","report","map","data visualization", "infographics"),size = 500, replace = TRUE)
sub_category <- sample(c("employment", "income","tax","labor force","wage","job","economy"),size= 500, replace = TRUE)
#stack_table <- xtabs(~ tool_category + sub_category, data = NULL)
#stack_table <- addmargins(stack_table)
# Set all cells to 0
#stack_table[ , ] <- 0
#stack_table["data visualization", "economy"]
data[data$State..Country== 'Alabama',]
sub_cat_and_tool <- function(selected_state){
df_stack2 <- data.frame(
tool = character(),
sub = character(),
count = numeric()
)
col_name = c("tool","sub","count")
colnames(df_stack2) <- col_name
if (selected_state == "All states" ){
data_to_use = data
}
else{
data_to_use = data[data$State..Country== selected_state,]
}
for (i in 1:nrow(data_to_use)) {
#--------------------------income----------------------------
if (any(grepl("income", data_to_use[i,3]))) {
if(any(grepl("table download", data_to_use[i,4]))){
new_row <- c("table download", "income",46)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("table", data_to_use[i,4]))){
new_row <- c("table", "income",46)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("report", data_to_use[i,4]))){
new_row <- c("report", "income",46)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("map", data_to_use[i,4]))){
new_row <- c("map", "income",46)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("visualization", data_to_use[i,4]))){
new_row <- c("data visualization", "income",46)
df_stack2 <- rbind(df_stack2, new_row)
}
}
#---------------------------employment----------------------------
if (any(grepl("employment", data_to_use[i,3]))) {
if(any(grepl("table download", data_to_use[i,4]))){
new_row <- c("table download", "employment",54)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("table", data_to_use[i,4]))){
new_row <- c("table", "employment",54)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("report", data_to_use[i,4]))){
new_row <- c("report", "employment",54)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("map", data_to_use[i,4]))){
new_row <- c("map", "employment",54)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("visualization", data_to_use[i,4]))){
new_row <- c("data visualization", "employment",54)
df_stack2 <- rbind(df_stack2, new_row)
}
}
#---------------------------tax----------------------------
if (any(grepl("tax", data_to_use[i,3]))) {
if(any(grepl("table download", data_to_use[i,4]))){
new_row <- c("table download", "tax",9)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("table", data_to_use[i,4]))){
new_row <- c("table", "tax",9)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("report", data_to_use[i,4]))){
new_row <- c("report", "tax",9)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("map", data_to_use[i,4]))){
new_row <- c("map", "tax",9)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("visualization", data_to_use[i,4]))){
new_row <- c("data visualization", "tax",9)
df_stack2 <- rbind(df_stack2, new_row)
}
}
#---------------------------labor force----------------------------
if (any(grepl("labor force", data_to_use[i,3]))) {
if(any(grepl("table download", data_to_use[i,4]))){
new_row <- c("table download", "labor force",18)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("table", data_to_use[i,4]))){
new_row <- c("table", "labor force",18)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("report", data_to_use[i,4]))){
new_row <- c("report", "labor force",18)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("map", data_to_use[i,4]))){
new_row <- c("map", "labor force",18)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("visualization", data_to_use[i,4]))){
new_row <- c("data visualization", "labor force",18)
df_stack2 <- rbind(df_stack2, new_row)
}
}
#---------------------------wage----------------------------
if (any(grepl("wage", data_to_use[i,3]))) {
if(any(grepl("table download", data_to_use[i,4]))){
new_row <- c("table download", "wage",22)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("table", data_to_use[i,4]))){
new_row <- c("table", "wage",22)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("report", data_to_use[i,4]))){
new_row <- c("report", "wage",22)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("map", data_to_use[i,4]))){
new_row <- c("map", "wage",22)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("visualization", data_to_use[i,4]))){
new_row <- c("data visualization", "wage",22)
df_stack2 <- rbind(df_stack2, new_row)
}
}
#---------------------------job----------------------------
if (any(grepl("job", data_to_use[i,3]))) {
if(any(grepl("table download", data_to_use[i,4]))){
new_row <- c("table download", "job",9)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("table", data_to_use[i,4]))){
new_row <- c("table", "job",9)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("report", data_to_use[i,4]))){
new_row <- c("report", "job",9)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("map", data_to_use[i,4]))){
new_row <- c("map", "job",9)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("visualization", data_to_use[i,4]))){
new_row <- c("data visualization", "job",9)
df_stack2 <- rbind(df_stack2, new_row)
}
}
#---------------------------economy----------------------------
if (any(grepl("economy", data_to_use[i,3]))) {
if(any(grepl("table download", data_to_use[i,4]))){
new_row <- c("table download", "economy",38)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("table", data_to_use[i,4]))){
new_row <- c("table", "economy",38)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("report", data_to_use[i,4]))){
new_row <- c("report", "economy",38)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("map", data_to_use[i,4]))){
new_row <- c("map", "economy",38)
df_stack2 <- rbind(df_stack2, new_row)
}
if(any(grepl("visualization", data_to_use[i,4]))){
new_row <- c("data visualization", "economy",38)
df_stack2 <- rbind(df_stack2, new_row)
}
}
}
colnames(df_stack2) <- col_name
ggplot(df_stack2, aes(x = sub, y = 1, fill = tool)) +
geom_col() +
scale_fill_manual(values = cbPalette) +
xlab("sub-category")+
ylab("count")+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
library(gcookbook) # Load gcookbook for the cabbage_exp data set
ggplot(df_stack2, aes(x = sub, y = 1, fill = tool)) +
geom_col() +
scale_fill_manual(values = cbPalette) +
xlab("sub-category")+
ylab("count")+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
pie(sorted_df$count , labels = combined_df$`data source`, border="white", col=cbPalette, cex=0.5)
pie(sorted_df$count , labels = combined_df$data source, border="white", col=cbPalette, cex=0.5)
pie(sorted_df$count , labels = combined_df$`data source`, border="white", col=cbPalette, cex=0.5)
combined_df$`data source`
combined_df
pie(sorted_df$count , labels = sorted_df$`data source`, border="white", col=cbPalette, cex=0.5)
pie(sorted_df$count , labels = sorted_df$`data source`, border="white", col=cbPalette, cex=0.55)
pie(sorted_df$count , labels = sorted_df$`data source`, border="white", col=cbPalette, cex=0.53)
pie(sorted_df$count , labels = sorted_df$`data source`, border="white", col=cbPalette, cex=0.52)
pie(sorted_df$count , labels = sorted_df$`data source`, border="white", col=cbPalette, cex=0.51)
pie(sorted_df$count , labels = sorted_df$`data source`, border="white", col=cbPalette, cex=0.5)
runApp('Documents/GitHub/dspg23census/project_web/web_code.R')
sub_cat_and_tool("All states")
runApp('Documents/GitHub/dspg23census/project_web/web_code.R')
runApp('Documents/GitHub/dspg23census/project_web/web_code.R')
pie(sorted_df$count, col = cbPalette)
legend("topright", legend = combined_df$`data source`, fill = cbPalette, cex = 0.5)
pie(sorted_df$count , labels = sorted_df$`data source`, border="white", col=cbPalette, cex=0.5)
runApp('Documents/GitHub/dspg23census/project_web/web_code.R')
runApp('Documents/GitHub/dspg23census/project_web/web_code.R')
pie_graph <-function(selected_state, data_table){
if (selected_state == "All states" ){
data_to_use = data_table
}
else{
data_to_use = data_table[data_table$State..Country== selected_state,]
}
count_result <- data_to_use %>% group_by(Data.Source.Census..Standardized.) %>% summarize(count = n())
if(nrow(count_result)>=0){
count_result <- count_result[-1, ]}
countinue <- data_to_use %>% group_by(Data.Source.Non.Census..Standardized.) %>% summarize(count = n())
if(nrow(countinue)>=0){
countinue <- countinue[-1, ]}
colnames(count_result) <- c("data source", "count")
colnames(countinue) <- c("data source", "count")
combined_df <- rbind(count_result, countinue)
sorted_df <- combined_df[order(- combined_df$count), ]
pie(sorted_df$count , labels = sorted_df$`data source`, border="white", col=cbPalette, cex=0.5)
}
pie_graph(data_table = data, selected_state = "Arizona")
data_to_use = data[data$State..Country== "Arizona",]
count_result <- data_to_use %>% group_by(Data.Source.Census..Standardized.) %>% summarize(count = n())
if(nrow(count_result)>=0){
count_result <- count_result[-1, ]}
countinue <- data_to_use %>% group_by(Data.Source.Non.Census..Standardized.) %>% summarize(count = n())
if(nrow(countinue)>=0){
countinue <- countinue[-1, ]}
colnames(count_result) <- c("data source", "count")
colnames(countinue) <- c("data source", "count")
combined_df <- rbind(count_result, countinue)
sorted_df <- combined_df[order(- combined_df$count), ]
pie(sorted_df$count , labels = sorted_df$`data source`, border="white", col=cbPalette, cex=0.5)
data_to_use = data[data$State..Country== "Arizona",]
count_result <- data_to_use %>% group_by(Data.Source.Census..Standardized.) %>% summarize(count = n())
print(count_result)
if(nrow(count_result)>=0){
count_result <- count_result[-1, ]}
countinue <- data_to_use %>% group_by(Data.Source.Non.Census..Standardized.) %>% summarize(count = n())
if(nrow(countinue)>=0){
countinue <- countinue[-1, ]}
colnames(count_result) <- c("data source", "count")
colnames(countinue) <- c("data source", "count")
combined_df <- rbind(count_result, countinue)
sorted_df <- combined_df[order(- combined_df$count), ]
pie(sorted_df$count , labels = sorted_df$`data source`, border="white", col=cbPalette, cex=0.5)
data_to_use = data[data$State..Country== "Arizona",]
count_result <- data_to_use %>% group_by(Data.Source.Census..Standardized.) %>% summarize(count = n())
colnames(count_result) <- c("data source", "count")
print(count_result)
if(nrow(count_result)>=0){
count_result <- count_result[-1, ]}
countinue <- data_to_use %>% group_by(Data.Source.Non.Census..Standardized.) %>% summarize(count = n())
colnames(countinue) <- c("data source", "count")
if(nrow(countinue)>=0){
countinue <- countinue[-1, ]}
combined_df <- rbind(count_result, countinue)
sorted_df <- combined_df[order(- combined_df$count), ]
pie(sorted_df$count , labels = sorted_df$`data source`, border="white", col=cbPalette, cex=0.5)
data_to_use = data[data$State..Country== "Arizona",]
count_result <- data_to_use %>% group_by(Data.Source.Census..Standardized.) %>% summarize(count = n())
colnames(count_result) <- c("data source", "count")
print(count_result)
if(nrow(count_result)>=0){
count_result <- count_result[-1, ]}
countinue <- data_to_use %>% group_by(Data.Source.Non.Census..Standardized.) %>% summarize(count = n())
print(countinue)
colnames(countinue) <- c("data source", "count")
if(nrow(countinue)>=0){
countinue <- countinue[-1, ]}
combined_df <- rbind(count_result, countinue)
sorted_df <- combined_df[order(- combined_df$count), ]
pie(sorted_df$count , labels = sorted_df$`data source`, border="white", col=cbPalette, cex=0.5)
data_to_use = data[data$State..Country== "Arizona",]
count_result <- data_to_use %>% group_by(Data.Source.Census..Standardized.) %>% summarize(count = n())
colnames(count_result) <- c("data source", "count")
print(count_result)
if(nrow(count_result)>=0){
count_result <- count_result[-1, ]}
countinue <- data_to_use %>% group_by(Data.Source.Non.Census..Standardized.) %>% summarize(count = n())
colnames(countinue) <- c("data source", "count")
print(countinue)
if(nrow(countinue)>=0){
countinue <- countinue[-1, ]}
combined_df <- rbind(count_result, countinue)
sorted_df <- combined_df[order(- combined_df$count), ]
pie(sorted_df$count , labels = sorted_df$`data source`, border="white", col=cbPalette, cex=0.5)
data_to_use = data[data$State..Country== "Arizona",]
count_result <- data_to_use %>% group_by(Data.Source.Census..Standardized.) %>% summarize(count = n())
colnames(count_result) <- c("data source", "count")
print(count_result)
if(nrow(count_result)==1){
count_result <- count_result[0, ]}
if(nrow(count_result)>1){
count_result <- count_result[-1, ]
}
countinue <- data_to_use %>% group_by(Data.Source.Non.Census..Standardized.) %>% summarize(count = n())
colnames(countinue) <- c("data source", "count")
print(countinue)
if(nrow(countinue)>=0){
countinue <- countinue[-1, ]}
combined_df <- rbind(count_result, countinue)
sorted_df <- combined_df[order(- combined_df$count), ]
pie(sorted_df$count , labels = sorted_df$`data source`, border="white", col=cbPalette, cex=0.5)
data_to_use = data[data$State..Country== "Arizona",]
count_result <- data_to_use %>% group_by(Data.Source.Census..Standardized.) %>% summarize(count = n())
colnames(count_result) <- c("data source", "count")
print(count_result)
if(nrow(count_result)==1){
count_result <- data.frame(names(count_result))
if(nrow(count_result)>1){
count_result <- count_result[-1, ]
}
countinue <- data_to_use %>% group_by(Data.Source.Non.Census..Standardized.) %>% summarize(count = n())
colnames(countinue) <- c("data source", "count")
print(countinue)
if(nrow(countinue)>=0){
countinue <- countinue[-1, ]}
combined_df <- rbind(count_result, countinue)
sorted_df <- combined_df[order(- combined_df$count), ]
pie(sorted_df$count , labels = sorted_df$`data source`, border="white", col=cbPalette, cex=0.5)
data_to_use = data[data$State..Country== "Arizona",]
count_result <- data_to_use %>% group_by(Data.Source.Census..Standardized.) %>% summarize(count = n())
colnames(count_result) <- c("data source", "count")
print(count_result)
if(nrow(count_result)==1){
count_result <- data.frame(names(count_result))}
if(nrow(count_result)>1){
count_result <- count_result[-1, ]
}
countinue <- data_to_use %>% group_by(Data.Source.Non.Census..Standardized.) %>% summarize(count = n())
colnames(countinue) <- c("data source", "count")
print(countinue)
if(nrow(countinue)>=0){
countinue <- countinue[-1, ]}
combined_df <- rbind(count_result, countinue)
sorted_df <- combined_df[order(- combined_df$count), ]
data_to_use = data[data$State..Country== "Arizona",]
count_result <- data_to_use %>% group_by(Data.Source.Census..Standardized.) %>% summarize(count = n())
colnames(count_result) <- c("data source", "count")
print(count_result)
if(nrow(count_result)==1){
count_result <- data.frame(names(count_result))}
if(nrow(count_result)>1){
count_result <- count_result[-1, ]
}
print(count_result)
countinue <- data_to_use %>% group_by(Data.Source.Non.Census..Standardized.) %>% summarize(count = n())
colnames(countinue) <- c("data source", "count")
print(countinue)
if(nrow(countinue)>=0){
countinue <- countinue[-1, ]}
combined_df <- rbind(count_result, countinue)
sorted_df <- combined_df[order(- combined_df$count), ]
data_to_use = data[data$State..Country== "Arizona",]
count_result <- data_to_use %>% group_by(Data.Source.Census..Standardized.) %>% summarize(count = n())
colnames(count_result) <- c("data source", "count")
print(count_result)
if(nrow(count_result)>1){
count_result <- count_result[-1, ]
}
print(count_result)
countinue <- data_to_use %>% group_by(Data.Source.Non.Census..Standardized.) %>% summarize(count = n())
colnames(countinue) <- c("data source", "count")
print(countinue)
if(nrow(countinue)>=0){
countinue <- countinue[-1, ]}
combined_df <- rbind(count_result, countinue)
sorted_df <- combined_df[order(- combined_df$count), ]
pie(sorted_df$count , labels = sorted_df$`data source`, border="white", col=cbPalette, cex=0.5)
data_to_use = data[data$State..Country== "Arizona",]
count_result <- data_to_use %>% group_by(Data.Source.Census..Standardized.) %>% summarize(count = n())
colnames(count_result) <- c("data source", "count")
print(count_result)
if(nrow(count_result)>1){
count_result <- count_result[-1, ]
}
print(count_result)
countinue <- data_to_use %>% group_by(Data.Source.Non.Census..Standardized.) %>% summarize(count = n())
colnames(countinue) <- c("data source", "count")
print(countinue)
if(nrow(countinue)>1){
countinue <- countinue[-1, ]}
combined_df <- rbind(count_result, countinue)
sorted_df <- combined_df[order(- combined_df$count), ]
pie(sorted_df$count , labels = sorted_df$`data source`, border="white", col=cbPalette, cex=0.5)
data_to_use = data[data$State..Country== "Arizona",]
count_result <- data_to_use %>% group_by(Data.Source.Census..Standardized.) %>% summarize(count = n())
colnames(count_result) <- c("data source", "count")
print(count_result)
if(nrow(count_result)>1){
count_result <- count_result[-1, ]
}
print(count_result)
countinue <- data_to_use %>% group_by(Data.Source.Non.Census..Standardized.) %>% summarize(count = n())
colnames(countinue) <- c("data source", "count")
print(countinue)
if(nrow(countinue)>1){
countinue <- countinue[-1, ]}
combined_df <- rbind(count_result, countinue)
print(combined_df)
sorted_df <- combined_df[order(- combined_df$count), ]
pie(sorted_df$count , labels = sorted_df$`data source`, border="white", col=cbPalette, cex=0.5)
data_to_use = data[data$State..Country== "Arizona",]
count_result <- data_to_use %>% group_by(Data.Source.Census..Standardized.) %>% summarize(count = n())
colnames(count_result) <- c("data source", "count")
print(count_result)
count_result<- count_result[count_result$`data source` != "", ]
#if(nrow(count_result)>1){
#  count_result <- count_result[-1, ]
#}
print(count_result)
countinue <- data_to_use %>% group_by(Data.Source.Non.Census..Standardized.) %>% summarize(count = n())
colnames(countinue) <- c("data source", "count")
print(countinue)
if(nrow(countinue)>1){
countinue <- countinue[-1, ]}
combined_df <- rbind(count_result, countinue)
print(combined_df)
sorted_df <- combined_df[order(- combined_df$count), ]
pie(sorted_df$count , labels = sorted_df$`data source`, border="white", col=cbPalette, cex=0.5)
data_to_use = data[data$State..Country== "Arizona",]
count_result <- data_to_use %>% group_by(Data.Source.Census..Standardized.) %>% summarize(count = n())
colnames(count_result) <- c("data source", "count")
count_result<- count_result[count_result$`data source` != "", ]
countinue <- data_to_use %>% group_by(Data.Source.Non.Census..Standardized.) %>% summarize(count = n())
colnames(countinue) <- c("data source", "count")
countinue<- countinue[countinue$`data source` != "", ]
combined_df <- rbind(count_result, countinue)
print(combined_df)
sorted_df <- combined_df[order(- combined_df$count), ]
pie(sorted_df$count , labels = sorted_df$`data source`, border="white", col=cbPalette, cex=0.5)
pie_graph <-function(selected_state, data_table){
if (selected_state == "All states" ){
data_to_use = data_table
}
else{
data_to_use = data_table[data_table$State..Country== selected_state,]
}
count_result <- data_to_use %>% group_by(Data.Source.Census..Standardized.) %>% summarize(count = n())
count_result<- count_result[count_result$`data source` != "", ]
countinue <- data_to_use %>% group_by(Data.Source.Non.Census..Standardized.) %>% summarize(count = n())
countinue<- countinue[countinue$`data source` != "", ]
colnames(count_result) <- c("data source", "count")
colnames(countinue) <- c("data source", "count")
combined_df <- rbind(count_result, countinue)
sorted_df <- combined_df[order(- combined_df$count), ]
pie(sorted_df$count , labels = sorted_df$`data source`, border="white", col=cbPalette, cex=0.5)
}
pie_graph("Arizona")
pie_graph(data_table = data, selected_state = "Arizona")
pie_graph <-function(selected_state, data_table){
if (selected_state == "All states" ){
data_to_use = data_table
}
else{
data_to_use = data_table[data_table$State..Country== selected_state,]
}
count_result <- data_to_use %>% group_by(Data.Source.Census..Standardized.) %>% summarize(count = n())
colnames(count_result) <- c("data source", "count")
count_result<- count_result[count_result$`data source` != "", ]
countinue <- data_to_use %>% group_by(Data.Source.Non.Census..Standardized.) %>% summarize(count = n())
colnames(countinue) <- c("data source", "count")
countinue<- countinue[countinue$`data source` != "", ]
combined_df <- rbind(count_result, countinue)
sorted_df <- combined_df[order(- combined_df$count), ]
pie(sorted_df$count , labels = sorted_df$`data source`, border="white", col=cbPalette, cex=0.5)
}
pie_graph(data_table = data, selected_state = "Arizona")
runApp('Documents/GitHub/dspg23census/project_web/web_code.R')
library(shiny); runApp('web_code.R')
runApp('web_code.R')
